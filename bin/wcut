#!/usr/bin/env python3
#; -*- mode: Python;-*-

import wcut

from wcut.deps.docopt import docopt
from wcut.deps.stdcheck import stdout_check
from wcut import io, cli


if __name__ == '__main__':
    args = docopt(wcut.cli.__doc__)
    cli.process_commandline(args)
    with stdout_check(args['-o'], source=wcut.__version__) as ofh:
        delim = args['--delimiter']
        match_lineno = args['--line']

        lines = io.get_lines(args['FILE'],
                             args['--remove-preheader'])

        fields = wcut.process_lines(lines, delim, args['WORDS'],
                                    match_lineno=match_lineno,
                                    wholename=args['--wholename'],
                                    ignore_case=args['--ignore-case'])
        io.write_fields(ofh, fields, delim)
